<div *ngIf="isDataLoaded">

  <div class="col-md-12">
    <div class="col-md-3 details-menu">
      <h2 class="detailsName">{{shop.name}}</h2>
      <a mat-raised-button color="primary" (click)="Edit()">{{'common-edit'|translate}}</a>
      <a mat-raised-button color="warn" (click)="Delete()">{{'common-delete'|translate}}</a>
      <a mat-raised-button color="basic"  (click)="GoBack()">{{'common-goback'|translate}}</a>

      <div class="detailsList">
        <div *ngIf="hasProducts" class="detailsListItems">
          <p>{{'shopdetails-productsbought'|translate}}:</p>
          <mat-list>
            <a mat-list-item (click)="ProductDetails(product)" *ngFor="let product of products">
              <mat-icon matListIcon>label</mat-icon>
              {{product.name}}
            </a>
          </mat-list>
        </div>
        <div *ngIf="!hasProducts">
          {{'shopdetails-noproducts'|translate}}
        </div>
        <br />
      </div>
    </div>

    <div class="col-md-9 statistics-menu">
      <div class="col-md-12 statistics-menu-dates">
        <span>{{'common-startdate'|translate}}:</span>
        <mat-form-field>
          <input matInput [matDatepicker]="startPicker" placeholder="{{'common-startdate'|translate}}" [(ngModel)]="startDate">
          <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
          <mat-datepicker #startPicker></mat-datepicker>
        </mat-form-field>
        <span>{{'common-enddate'|translate}}:</span>
        <mat-form-field>
          <input matInput [matDatepicker]="endPicker" placeholder="{{'common-enddate'|translate}}" [(ngModel)]="endDate">
          <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
          <mat-datepicker #endPicker></mat-datepicker>
        </mat-form-field>
        <a mat-button color="basic"  (click)="SetDates()">{{'common-setdates'|translate}}</a>
      </div>
      <div class="col-md-12">
        <div *ngIf="summary.totalTimesBoughtAmount==0">
          {{'common-statistics-empty'|translate}}
        </div>
        <div *ngIf="summary.totalTimesBoughtAmount>0">
          <mat-accordion class="example-headers-align" [multi]="true">
            <mat-expansion-panel class="statistics-panel" [expanded]="step === 0" (opened)="setStep(0)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-totalTimesBoughtAmount'|translate}}
                </mat-panel-title>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.visitAmount}} </span> <span class="summaryText">- {{'shopdetails-totalTimesBoughtAmount-description'|translate}} </span>
              </ng-template>
              <p>tyle razy odwiedzony</p>

              <mat-action-row>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 1" (opened)="setStep(1)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-totalMoneySpent'|translate}}
                </mat-panel-title>
                <p>tyle wydane</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.moneySpentAmount}} {{currency}} </span> <span class="summaryText">- {{'shopdetails-totalMoneySpent-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 2" (opened)="setStep(2)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-minPrice'|translate}}
                </mat-panel-title>
                <p>tyle średnio wydane</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.moneyAverageSpentAmount}} {{currency}}</span> <span class="summaryText">- {{'shopdetails-minPrice-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 3" (opened)="setStep(3)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-averagePrice'|translate}}
                </mat-panel-title>
                <p>tyle najwiecej wydane</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.moneyMaxSpentAmount}} {{currency}}</span> <span class="summaryText">- {{'shopdetails-averagePrice-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>


            <mat-expansion-panel class="statistics-panel" [expanded]="step === 4" (opened)="setStep(4)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-maxPrice'|translate}}
                </mat-panel-title>
                <p>tyle najmniej wydane</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.moneyMinSpentAmount}} {{currency}}</span> <span class="summaryText">- {{'shopdetails-maxPrice-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 5" (opened)="setStep(5)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-shopsAmount'|translate}}
                </mat-panel-title>
                <p>tyle kupiono produktów łącznie (nie sztuk)</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.productsBoughtTotalAmount}}</span> <span class="summaryText">- {{'shopdetails-shopsAmount-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 5" (opened)="setStep(5)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-shopsAmount'|translate}}
                </mat-panel-title>
                <p>tyle kupiono produktów srednio (nie sztuk)</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.productsBoughtAverageAmount}}</span> <span class="summaryText">- {{'shopdetails-shopsAmount-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 5" (opened)="setStep(5)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-shopsAmount'|translate}}
                </mat-panel-title>
                <p>tyle kupiono produktów najmniej (nie sztuk)</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.productsBoughtMinAmount}}</span> <span class="summaryText">- {{'shopdetails-shopsAmount-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 5" (opened)="setStep(5)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-shopsAmount'|translate}}
                </mat-panel-title>
                <p>tyle kupiono produktów najwiecej (nie sztuk)</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.productsBoughtMaxAmount}}</span> <span class="summaryText">- {{'shopdetails-shopsAmount-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 5" (opened)="setStep(5)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-shopsAmount'|translate}}
                </mat-panel-title>
                <p>tyle kategorii kupionych w sklepie</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.totalCategoriesAmount}}</span> <span class="summaryText">- {{'shopdetails-shopsAmount-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 5" (opened)="setStep(5)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-shopsAmount'|translate}}
                </mat-panel-title>
                <p>tyle srednio kategorii na jeden rachunek</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.averageCategoryAmountForReceipt}}</span> <span class="summaryText">- {{'shopdetails-shopsAmount-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 5" (opened)="setStep(5)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-shopsAmount'|translate}}
                </mat-panel-title>
                <p>tyle najmniej kategorii na jeden rachunek</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.minCategoryAmountForReceipt}}</span> <span class="summaryText">- {{'shopdetails-shopsAmount-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 5" (opened)="setStep(5)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-shopsAmount'|translate}}
                </mat-panel-title>
                <p>tyle najwiecej kategorii na jeden rachunek</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.maxCategoryAmountForReceipt}}</span> <span class="summaryText">- {{'shopdetails-shopsAmount-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>


            <mat-expansion-panel class="statistics-panel" [expanded]="step === 6" (opened)="setStep(6)" >
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-averageMoneySpentOnEachCategory'|translate}}
                </mat-panel-title>
              </mat-expansion-panel-header>
              <div class="chart-panel">
                <ngx-charts-bar-vertical
                  [view]="view"
                  [scheme]="scheme"
                  [results]="summary.averageMoneySpentOnEachCategory"
                  [gradient]="false"
                  [xAxis]="true"
                  [yAxis]="true"
                  [legend]="false"
                  [showXAxisLabel]="true"
                  [showYAxisLabel]="true"
                  [xAxisLabel]='moneySpentXLabel'
                  [yAxisLabel]='moneySpentYLabel'
                  (select)="onSelect($event)">
                </ngx-charts-bar-vertical>
              </div>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 7" (opened)="setStep(7)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-shopWithCheapestPriceName'|translate}}
                </mat-panel-title>
                <p>tyle srednio wydano dziennie</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.averageMoneySpentPerDay}}</span> <span class="summaryText">- {{'shopdetails-shopWithCheapestPriceName-description'|translate}}</span>

              </ng-template>
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 8" (opened)="setStep(8)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-shopWithMostExpensivePriceName'|translate}}
                </mat-panel-title>
                <p>tyle łącznie kupiono sztuk produktu</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.totalProductAmountBought}}</span> <span class="summaryText">- {{'shopdetails-shopWithMostExpensivePriceName-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 9" (opened)="setStep(9)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-averageAmountOnReceipt'|translate}}
                </mat-panel-title>
                <p>tyle minimum na jednen rachunek kupiono sztuk produktu</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.minProductAmountBought}}</span> <span class="summaryText">- {{'shopdetails-averageAmountOnReceipt-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 10" (opened)="setStep(10)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-minAmountOnReceipt'|translate}}
                </mat-panel-title>
                <p>tyle maksimum na jednen rachunek kupiono sztuk produktu</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.maxProductAmountBought}}</span> <span class="summaryText">- {{'shopdetails-minAmountOnReceipt-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 11" (opened)="setStep(11)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-maxAmountOnReceipt'|translate}}
                </mat-panel-title>
                <p>tyle srednio na jednen rachunek kupiono sztuk produktu</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.averageProductAmountBought}}</span> <span class="summaryText">- {{'shopdetails-maxAmountOnReceipt-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 12" (opened)="setStep(12)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-percentageAmountOfTotalMoneySpent'|translate}}
                </mat-panel-title>
                <p>najpopularniejsza kategoria</p>
              </mat-expansion-panel-header>

              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.mostPopularCategoryName}} %</span> <span class="summaryText">- {{'shopdetails-percentageAmountOfTotalMoneySpent-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-next'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel class="statistics-panel" [expanded]="step === 13" (opened)="setStep(13)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{'shopdetails-averageCostPerDay'|translate}}
                </mat-panel-title>
                <p>najmniej popularna kategoria</p>
              </mat-expansion-panel-header>
              <ng-template matExpansionPanelContent>
                <span class="summaryNumber">{{summary.leastPopularCategoryName}} {{currency}}</span> <span class="summaryText">- {{'shopdetails-averageCostPerDay-description'|translate}}</span>
              </ng-template>

              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">{{'common-previous'|translate}}</button>
                <button mat-button color="primary" (click)="nextStep()">{{'common-end'|translate}}</button>
              </mat-action-row>
            </mat-expansion-panel>

          </mat-accordion>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="!isDataLoaded">
  <mat-spinner></mat-spinner>
</div>


